# NomadSuite — Invoice Template & Customization Module Spec ## Purpose Provide global-nomad and freelancer users with the ability to define multiple invoice templates tailored to different currencies, locales, tax regimes, and branding — enabling them to invoice clients worldwide easily, professionally and correctly. ## Requirements ### Data Model Define data entities for: - InvoiceTemplate - Fields: template_id, user_id, name, default_currency, default_locale, branding (logo_url, company_name, address, contact_info, VAT_ID), color_theme, invoice_number_mask, next_invoice_number, tax_settings (tax_rate, tax_label, tax_mode, tax_id_field_visible, reverse_charge_flag), default_payment_terms, default_payment_methods/instructions, footer_text, footer_image_url, default_line_item_settings, created_at, updated_at. - Invoice (existing) must reference a template_id (nullable) so invoice inherits template defaults when created. ### API Endpoints (REST) - `GET /templates` — list all templates for a user - `POST /templates` — create new template - `PUT /templates/{id}` — update template - `DELETE /templates/{id}` — delete template (with confirm; prevent deletion if used by existing invoices or require re-assignment) - `POST /templates/{id}/clone` — duplicate a template for quick variation - `GET /templates/{id}/preview` — generate a preview invoice (sample data) as HTML/PDF for user review ### Front-end / UI - “Templates Manager” page under user settings or invoicing section - List view of templates + “Create New Template” button - Template Editor UI (form) with sections as specified (General → Branding → Numbering → Tax & Pricing → Payment Terms → Footer → Preview) - Live preview pane (desktop + mobile) showing invoice layout with sample data (company info, client info placeholder, sample line-items) - Help/tooltips for complex fields (tax mode, locale formatting, reverse-charge) - File upload support for logo (with size & format restrictions; preview) - Color picker UI for brand color theme ### Business Logic - When user creates a new invoice, default to user’s default template or detect based on client’s country/currency; allow override - Invoice numbering: apply mask + auto-increment; ensure uniqueness per user account + template - Currency & locale formatting: use standard localisation libs (Intl / i18n) to format numbers, dates, currency symbol placement based on template locale - Tax calculation: if tax applies, compute tax line(s) and total correctly (support tax-exclusive and tax-inclusive modes) - PDF generation: convert invoice HTML + template to PDF for sending; ensure layout works across currencies and different number-of-line-items ### Non-Functional Requirements - Multi-tenant data isolation: ensure each user sees only their templates/invoices - Security: secure upload & storage of logos/images; sanitize inputs to prevent XSS or injection via footer/notes - Responsiveness: UI should work well on desktop and tablet (mobile optional initially) - Performance: preview generation must be fast (< 300ms ideally for HTML; PDF generation async if needed) ## Acceptance Criteria - User can create >1 template, save them, see list - Creating invoice picks correct defaults from template - Invoices generated across currencies show correct number/date formatting, currency symbols, tax / total calculation, unique invoice number - PDF export visually matches preview, logo displayed, layout correct, all fields present (company info, client info placeholder, line-items, totals, tax, footer, etc.) - Deleting a template in use prevents or warns the user; clone works ## Optional / Stretch Goals - Allow multiple language static texts (e.g. invoice labels) per template (English, French, German...) depending on client locale - Support uploading footer-image (e.g. digital signature, compliance seal) - Template version history — track changes to templates, rollback